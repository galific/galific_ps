var kaliumGroupedMetaboxes={};!function(p,t,n){"use strict";p(document).ready(function(){if("undefined"!=typeof acf){p.extend(n,{setLoading:function(t){var e;p("#kalium-acfpro-grouped-metaboxes")[t?"addClass":"removeClass"]("is-loading")},cacheId:function(){var t;return"kalium_acfpro_gm_tab_"+acf.data.post_id},setActiveTab:function(t){"object"==typeof store&&store.enabled&&store.set(n.cacheId(),{activeTab:t})},getActiveTab:function(){if("object"==typeof store&&store.enabled){var t=store.get(n.cacheId());if(t&&"activeTab"in t)return t.activeTab}return null}});var t=function(){"undefined"!=typeof acf&&this.init()};t.prototype.init=function(){var a=this,t="kalium-acfpro-grouped-metaboxes";this.groupedMetaboxes=_k.groupedMetaboxes,this.assignedContentTabs=[],this.currentTab="",this.$tabs=p("."+t+"-tabs"),this.$body=p("."+t+"-body"),this.$container=p("."+t+"-container"),this.buildTabsList(),this.assignContentTabs(),this.toggleVisibleTabs(),this.setActiveTab(),this.$container.addClass("loaded"),acf.addAction("check_screen_complete",function(t,e){a.assignContentTabs(),a.toggleVisibleTabs(),a.setActiveTab()})},t.prototype.getPostboxes=function(){var i=[],s=[];for(var t in this.groupedMetaboxes)s.push(t);return p.each(acf.getPostboxes(),function(t,e){var a=e.data.key;-1!==p.inArray(a,s)&&i.push(e)}),i},t.prototype.buildTabsList=function(){var n=this;p.each(this.groupedMetaboxes,function(e,t){var a=p('<li><a href="#"></a></li>'),i=t.title,s=t.icon;a.attr("data-group-key",e);var o=a.find("a");i=i.replace(/\s\(Portfolio Type.*?\)/i,""),o.html(i),s&&o.prepend('<i class="fa fa-'+s+'"></i>'),n.$tabs.append(a),o.on("click",function(t){t.preventDefault(),n.setActiveTab(e,!0)})})},t.prototype.assignContentTabs=function(){var o=this;p.each(o.getPostboxes(),function(t,e){var a=e.data.id,i=p("#"+a);if(-1===p.inArray(o.assignedContentTabs,a)){var s=p('<div class="tab-entry"></div>');s.appendTo(o.$body),s.append(e.$el),o.assignedContentTabs.push(a)}})},t.prototype.toggleVisibleTabs=function(){var s=this;p.each(s.getPostboxes(),function(t,e){var a=!e.isVisible(),i=s.getTab(e);i&&i.$el[a?"addClass":"removeClass"]("visible")}),this.maintainHeight()},t.prototype.maintainHeight=function(){this.$body.css("min-height",this.$tabs.outerHeight())},t.prototype.getTab=function(a){var i=this,s=null;return p.each(this.groupedMetaboxes,function(t,e){if(t===a.data.key)return(s=e).id=t,s.$el=i.$tabs.find('[data-group-key="'+t+'"]'),!1}),s},t.prototype.getActiveTab=function(){var t=this,a=null;return p.each(t.getPostboxes(),function(t,e){if(!e.isVisible())return a=e.data.key,!1}),p.each(t.getPostboxes(),function(t,e){if(n.getActiveTab()===e.data.key)return a=e.data.key,!1}),a},t.prototype.setActiveTab=function(t,e){t||(t=this.currentTab?this.currentTab:this.getActiveTab());var a=acf.getPostbox("acf-"+t);if(a){var i=this.getTab(a);i.$el.siblings().removeClass("active"),i.$el.addClass("active");var s=a.$el.parent(),o;s.siblings().removeClass("active"),s.addClass("active"),this.currentTab=t,e&&n.setActiveTab(t),this.maintainHeight()}};var e=function(){"undefined"!=typeof acf&&(acf.data.acf_version.match(/^5\.7\.[0-9]{2}$/)?new t:this.init())};e.prototype.init=function(){var s=this,t="kalium-acfpro-grouped-metaboxes";this.groupedMetaboxes=_k.groupedMetaboxes,this.currentTab="",this.$tabs=p("."+t+"-tabs"),this.$body=p("."+t+"-body"),this.$container=p("."+t+"-container"),this.postboxList=[];var e=acf.getPostboxes();p.each(e,function(t,e){var a=e.get("key");if(a in s.groupedMetaboxes){var i=s.groupedMetaboxes[a];i.isVisible=function(){return e.$el.attr("style")?!e.$el.attr("style").match(/display:\s?none/):e.isVisible()},e.set("groupedMetaboxData",i),s.postboxList.push(e)}}),this.buildTabsList(),this.toggleVisibleTabs();var a=n.getActiveTab();a&&this.setActiveTab(a,!0),s.resetCurrentTab(),this.$container.addClass("loaded"),acf.addFilter("check_screen_args",function(t){return n.setLoading(!0),t}),acf.addAction("check_screen_complete",function(t,e){s.toggleVisibleTabs(),s.resetCurrentTab(),n.setLoading(!1)})},e.prototype.buildTabsList=function(){var d=this;p.each(this.postboxList,function(t,e){var a=p('<li><a href="#"></a></li>'),i=p('<div class="tab-entry"></div>'),s=e.get("groupedMetaboxData"),o=e.get("id"),n=s.title,r=s.icon,c=a.find("a");n=n.replace(/\s\(Portfolio Type.*?\)/i,""),c.html(n),r&&c.prepend('<i class="fa fa-'+r+'"></i>'),s.$tab=a,d.$tabs.append(a),i.appendTo(d.$body),i.append(e.$el),c.on("click",function(t){t.preventDefault(),d.setActiveTab(o,!0)})})},e.prototype.toggleVisibleTabs=function(){p.each(this.postboxList,function(t,e){var a=e.get("groupedMetaboxData");a.$tab[a.isVisible()?"addClass":"removeClass"]("visible")}),this.maintainHeight()},e.prototype.maintainHeight=function(){this.$body.css("min-height",this.$tabs.outerHeight())},e.prototype.setActiveTab=function(t,e){var a=acf.getPostbox(t);if(a&&a.get("id")!==this.currentTab){var i=a.get("id"),s=a.get("groupedMetaboxData");this.$body.find(".tab-entry.active").removeClass("active"),this.$tabs.find("li.active").removeClass("active"),s.$tab.addClass("active"),a.$el.parent().addClass("active"),e&&n.setActiveTab(i),this.currentTab=i,this.maintainHeight()}},e.prototype.resetCurrentTab=function(){var s=this,i=!1;p.each(this.postboxList,function(t,e){var a=e.get("groupedMetaboxData");if(a.isVisible()&&a.$tab.hasClass("active"))return!(i=!0)}),i||p.each(this.postboxList,function(t,e){var a=e.get("id"),i;if(e.get("groupedMetaboxData").isVisible())return s.setActiveTab(a),!1})},new e}})}(jQuery,window,kaliumGroupedMetaboxes),function(u,b){"use strict";u(document).ready(function(){if("undefined"!=typeof acf){var i=function(t){var n="kalium-acfpro-portfolio-item-type",r={"type-1":"portfolio-item-type-1.png","type-2":"portfolio-item-type-2.png","type-3":"portfolio-item-type-3.png","type-4":"portfolio-item-type-4.png","type-5":"portfolio-item-type-5.png","type-6":"portfolio-item-type-6.png","type-7":"portfolio-item-type-7.png"};for(var e in r)r[e]=_k.kaliumAssetsDir+"images/admin/"+r[e];t.addClass(n);var a=t.find(".acf-input"),c=a.find("select"),i=b.location.toString().match(/action=edit/),s=[c.val(),c.find("option:selected").html()],o=c.val(),d=u('<div class="'+n+'-images"><div class="loader"></div></div>');a.before(d),c.find("option").each(function(t,e){var a=u(e),i=a.val(),s=a.html(),o=u('<a href="#" class="'+n+'-option" data-value="'+i+'"><span><img src="'+r[i]+'" /></span><strong>'+s+"</strong></a>");o.find("img").on("load",function(){u(this).addClass("loaded")}),d.append(o),o.on("click",function(t){t.preventDefault(),a.prop("selected",!0).attr("selected",!0),c.trigger("change")})});var p=u('<div class="'+n+'-warning"></div>');i&&(p.append("<strong>Note:</strong> You are currently using <strong>"+s[1]+"</strong> type. If you change this portfolio type you may lose/overwrite some of the current settings."),d.after(p));var l=function(t){var e=c.val();(t||o!=e)&&(d.find("."+n+"-option").removeClass("active"),d.find("."+n+'-option[data-value="'+e+'"]').addClass("active"),o=e,acf.screen.data.item_type=e,acf.screen.check(),d.addClass("is-loading"),kaliumGroupedMetaboxes.setLoading(!0),e!=s[0]?p.slideDown(300):p.slideUp(300))};c.on("change",l),d.find("."+n+'-option[data-value="'+c.val()+'"]').addClass("active"),acf.addAction("check_screen_complete",function(t,e){"item_type"in e&&(d.removeClass("is-loading"),kaliumGroupedMetaboxes.setLoading(!1))},1),"post-new-php"==adminpage&&l(!0)},t=acf.getFields({name:"item_type"});t.length&&u.each(t,function(t,e){var a=e.$el;i(a)})}})}(jQuery,window);